# ChatCLI Helm Chart - Default Values

replicaCount: 1

image:
  repository: ghcr.io/diillson/chatcli
  tag: latest
  pullPolicy: IfNotPresent

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

# gRPC server configuration
server:
  port: 50051
  # Prometheus metrics HTTP port (0 = disabled)
  metricsPort: 9090
  # Authentication token for gRPC server (leave empty to disable auth)
  token: ""

# TLS configuration
tls:
  enabled: false
  # certFile and keyFile are paths inside the container
  certFile: ""
  keyFile: ""
  # Use existing secret for TLS certificates
  existingSecret: ""

# LLM Provider configuration
llm:
  # Default provider: OPENAI, CLAUDEAI, GOOGLEAI, XAI, STACKSPOT, OLLAMA
  provider: ""
  model: ""

# Provider API keys (stored in a Secret)
# Set these values or use existingSecret
secrets:
  # Use an existing secret instead of creating one
  existingSecret: ""
  openaiApiKey: ""
  anthropicApiKey: ""
  googleaiApiKey: ""
  xaiApiKey: ""
  # StackSpot
  stackspotClientId: ""
  stackspotClientKey: ""
  stackspotRealm: ""
  stackspotAgentId: ""

# Ollama configuration (if using Ollama provider)
ollama:
  enabled: false
  baseUrl: "http://ollama:11434"
  model: ""

# Kubernetes Watcher mode
watcher:
  enabled: false

  # Single-target mode (legacy) — use "deployment" + "namespace"
  deployment: ""
  namespace: ""

  # Multi-target mode — use "targets" list (takes precedence over deployment/namespace)
  # targets:
  #   - deployment: api-gateway
  #     namespace: production
  #     metricsPort: 9090
  #     metricsPath: "/metrics"
  #     metricsFilter: ["http_requests_*", "http_request_duration_*"]
  #   - deployment: auth-service
  #     namespace: production
  #     metricsPort: 9090
  #   - deployment: worker
  #     namespace: batch
  targets: []

  interval: "30s"
  window: "2h"
  maxLogLines: 100
  # Budget maximo de caracteres para contexto LLM (multi-target)
  maxContextChars: 32000

serviceAccount:
  create: true
  name: ""
  annotations: {}

# RBAC for K8s watcher mode
rbac:
  create: true
  # Set to true to use ClusterRole/ClusterRoleBinding instead of namespace-scoped Role/RoleBinding.
  # Default false (least-privilege: namespace-scoped).
  clusterWide: false
  # Additional rules beyond the defaults
  additionalRules: []

service:
  type: ClusterIP
  port: 50051
  # Enable headless Service for gRPC client-side load balancing with multiple replicas.
  # When true, DNS returns individual pod IPs instead of a virtual IP,
  # allowing gRPC round-robin distribution across all pods.
  # Recommended when replicaCount > 1.
  headless: false

ingress:
  enabled: false
  className: ""
  annotations: {}
  hosts:
    - host: chatcli.local
      paths:
        - path: /
          pathType: ImplementationSpecific
  tls: []

resources:
  requests:
    memory: "128Mi"
    cpu: "100m"
  limits:
    memory: "512Mi"
    cpu: "500m"

# Pod-level security context
podSecurityContext:
  runAsNonRoot: true
  runAsUser: 1000
  runAsGroup: 1000
  fsGroup: 1000
  seccompProfile:
    type: RuntimeDefault

# Container-level security context
securityContext:
  allowPrivilegeEscalation: false
  readOnlyRootFilesystem: true
  capabilities:
    drop:
      - ALL

nodeSelector: {}
tolerations: []
affinity: {}

# Prometheus ServiceMonitor (requires Prometheus Operator)
serviceMonitor:
  enabled: false
  interval: "30s"
  scrapeTimeout: ""
  labels: {}

# Extra environment variables
extraEnv: []
# - name: LOG_LEVEL
#   value: "debug"

# Persistence for sessions
persistence:
  enabled: true
  storageClass: ""
  accessModes:
    - ReadWriteOnce
  size: 1Gi

# Agent/Skill provisioning (remote resource discovery)
agents:
  enabled: false
  # Inline agent definitions (creates ConfigMap automatically)
  # Each key is the filename (e.g., coder.md), value is the full markdown content
  definitions: {}
  #   coder.md: |
  #     ---
  #     name: coder
  #     description: Expert coder agent
  #     model: gpt-4
  #     skills: [golang, docker]
  #     ---
  #     You are an expert coder...
  # Or reference an existing ConfigMap containing agent .md files
  existingConfigMap: ""

skills:
  enabled: false
  # Inline skill definitions (creates ConfigMap automatically)
  definitions: {}
  #   golang.md: |
  #     ---
  #     name: golang
  #     description: Go programming skill
  #     ---
  #     You are a Go expert...
  # Or reference an existing ConfigMap containing skill .md files
  existingConfigMap: ""

# Plugin provisioning (remote resource discovery)
plugins:
  enabled: false
  # Init container image containing plugin binaries in /plugins/
  # The init container copies binaries to the chatcli plugins directory
  initImage: ""
  # Or reference an existing PVC with pre-installed plugin binaries
  existingPVC: ""
